
@{
    ViewData["Title"] = "Index";
}
<div class="container">

    <h3>Admin panel</h3>

    <hr />

    <h4>Companies</h4>

    <div class="row">
        <div class="col-12">
            <ul>
                <li>Total companies: @ViewData["TotalCompanies"]</li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <label>Generate companies</label>
            @Html.ActionLink("Generate companies", "GenerateCompanies", "Admin")
        </div>
        <div class="col-12">
            <label>Delete all companies</label>
            @Html.ActionLink("Delete companies", "DeleteCompanies", "Admin")
        </div>
        <div class="col-12">
            <label>Delete all companies</label>
            @Html.ActionLink("Add Companies To Shipments", "AddCompaniesToShipments", "Admin")
        </div>
    </div>

    <hr />

    <h4>Search phrases</h4>

    <div class="row">
        <div class="col-12">
            <ul>
                <li>Count: @ViewData["SearchPhrases"]</li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <label>Index Phrases</label>
            @Html.ActionLink("Index phrases", "IndexPhrases", "Admin")
        </div>
    </div>

    <hr />

    <h4>DataEverywhere Integration</h4>

    <div class="row mt-3" id="DEIntegration">
        <div class="col-12">
            <span>Pending requests: {{updateCount}}</span>
            <a href="javascript:;" v-on:click="getUpdateCount()">Refresh</a>
            <a class="ml-2" href="javascript:;" v-on:click="updateFeeds()">Update All</a>
        </div>
    </div>
</div>

@section scripts {
    <script>
        var App = new Vue({
            el: "#DEIntegration",
            data: {
                updateCount: 0
            },
            methods: {
                getUpdateCount: function () {
                    let self = this;
                    self.updateCount = "refreshing..."

                    $.ajax({
                        url: "admin/DEUpdateNeededCount", success: function (result) {
                            self.updateCount = result;
                        }
                    });
                },
                updateFeeds: function () {
                    let self = this;
                    self.updateCount = "processing..."
                    $.ajax({
                        url: "admin/DEUpdateFeeds", success: function (result) {
                            self.getUpdateCount();
                        }
                    });
                }
            }
        });
    </script>
}


